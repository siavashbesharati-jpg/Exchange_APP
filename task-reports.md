# ฺฏุฒุงุฑุด ุชุณฺฉโูุง ุชฺฉูู ุดุฏู - ูพุฑูฺู Exchange_APP

---

## ๐ ุชุงุฑุฎ: ฒถ ุดูุฑูุฑ ฑดฐณ - ุณุงุนุช ฑด:ณฐ

### ๐ฏ **ุชุณฺฉ: ุงุถุงูู ฺฉุฑุฏู ูุชุฏูุง ุชูุธู ุฏุณุช ุจู ุณุฑูุณ ูุฑฺฉุฒ**
**ูุถุนุช: โ ุชฺฉูู ุดุฏู**

---

## ๐ **ุดุฑุญ ฺฉุงูู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู:**

### **ฑ. ุงุถุงูู ฺฉุฑุฏู ูุชุฏูุง ุชูุธู ุฏุณุช ุจู ICentralFinancialService**
- โ **CreateManualPoolBalanceHistoryAsync**: ุงุฌุงุฏ ุฑฺฉูุฑุฏ ุฏุณุช ุจุฑุง ุชุงุฑุฎฺู ููุฌูุฏ ุตูุฏูู ุงุฑุฒ
- โ **DeleteManualPoolBalanceHistoryAsync**: ุญุฐู ุฑฺฉูุฑุฏ ุฏุณุช ุตูุฏูู ุจุง ุจุงุฒูุญุงุณุจู ููุฌูุฏ
- โ **CreateManualBankAccountBalanceHistoryAsync**: ุงุฌุงุฏ ุฑฺฉูุฑุฏ ุฏุณุช ุจุฑุง ุชุงุฑุฎฺู ุญุณุงุจ ุจุงูฺฉ
- โ **DeleteManualBankAccountBalanceHistoryAsync**: ุญุฐู ุฑฺฉูุฑุฏ ุฏุณุช ุญุณุงุจ ุจุงูฺฉ ุจุง ุจุงุฒูุญุงุณุจู ููุฌูุฏ

### **ฒ. ูพุงุฏูโุณุงุฒ ูุชุฏูุง ุฏุฑ CentralFinancialService**
- โ **ุงูฺฏูุฑุชู ุฒูุฌุฑู coherent**: ุญูุธ ุชูุงู ุตุญุญ BalanceBefore โ TransactionAmount โ BalanceAfter
- โ **ุจุงุฒูุญุงุณุจู ุฎูุฏฺฉุงุฑ**: ุจุฑูุฒุฑุณุงู ุชูุงู ุชุฑุงฺฉูุดโูุง ุจุนุฏ ูพุณ ุงุฒ ุฏุฑุฌ/ุญุฐู ุฑฺฉูุฑุฏ ุฏุณุช
- โ **ุงุนูุงูโูุง ุณฺฏูุงูโุขุฑ**: ุงุฑุณุงู ููุชูฺฉุดู ุจู ฺฉุงุฑุจุฑุงู ุงุฏูู (ุจู ุฌุฒ ฺฉุงุฑุจุฑ ุงูุฌุงูโุฏููุฏู)
- โ **ุงุนุชุจุงุฑุณูุฌ**: ุจุฑุฑุณ ฺฉูพุงุฑฺฺฏ ูุญุงุณุจุงุช ููุฌูุฏ ุฏุฑ ูุฑ ูุฑุญูู

### **ณ. ุจุฑูุฒุฑุณุงู ReportsController**
- โ **ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณ ูุฑฺฉุฒ**: ุฌุงฺฏุฒู ุนููุงุช ูุณุชูู ุฏุชุงุจุณ ุจุง ูุชุฏูุง ุณุฑูุณ ูุฑฺฉุฒ
- โ **ุซุจุงุช ุฏุฑ ุนููุงุช**: ุงุทููุงู ุงุฒ ุจุงุฒูุญุงุณุจู ุตุญุญ ููุฌูุฏโูุง ูพุณ ุงุฒ ุชูุธูุงุช ุฏุณุช
- โ **ูพุงูโูุง ฺฉูพุงุฑฺู**: ููุงุด ูพุงูโูุง ูููู/ุฎุทุง ุจู ุฒุจุงู ูุงุฑุณ

### **ด. ูุชุฏูุง ฺฉูฺฉ ุจุงุฒูุญุงุณุจู**
- โ **RecalculateCurrencyPoolBalanceFromDateAsync**: ุจุงุฒูุญุงุณุจู ููุฌูุฏ ุตูุฏูู ุงุฒ ุชุงุฑุฎ ูุดุฎุต
- โ **RecalculateBankAccountBalanceFromDateAsync**: ุจุงุฒูุญุงุณุจู ููุฌูุฏ ุญุณุงุจ ุจุงูฺฉ ุงุฒ ุชุงุฑุฎ ูุดุฎุต

---

## ๐ง **ุฌุฒุฆุงุช ุชฺฉูฺฉ:**

### **ูุชุฏูุง ุฌุฏุฏ ุฏุฑ ICentralFinancialService:**
```csharp
Task CreateManualPoolBalanceHistoryAsync(string currencyCode, decimal adjustmentAmount, string reason, DateTime transactionDate, string performedBy, string? performingUserId);
Task DeleteManualPoolBalanceHistoryAsync(long transactionId, string performedBy, string? performingUserId);
Task CreateManualBankAccountBalanceHistoryAsync(int bankAccountId, decimal amount, string reason, DateTime transactionDate, string performedBy, string? performingUserId);
Task DeleteManualBankAccountBalanceHistoryAsync(long transactionId, string performedBy, string? performingUserId);
```

### **ุงูฺฏูุฑุชู coherent balance:**
```csharp
// ฑ. ุงูุชู ุชุฑุงฺฉูุดโูุง ูุจู ุจุฑ ุงุณุงุณ ุชุงุฑุฎ
var priorTransactions = await _context.CurrencyPoolHistory
    .Where(h => h.CurrencyCode == currencyCode && h.TransactionDate <= transactionDate && !h.IsDeleted)
    .OrderBy(h => h.TransactionDate).ThenBy(h => h.Id)
    .ToListAsync();

// ฒ. ูุญุงุณุจู BalanceBefore ุตุญุญ
decimal balanceBefore = priorTransactions.Any() ? 
    priorTransactions.Last().BalanceAfter : 0m;

// ณ. ุงุฌุงุฏ ุฑฺฉูุฑุฏ ุจุง ุฒูุฌุฑู coherent
var historyRecord = new CurrencyPoolHistory {
    BalanceBefore = balanceBefore,
    TransactionAmount = adjustmentAmount,
    BalanceAfter = balanceBefore + adjustmentAmount
};
```

### **ุจุงุฒูุญุงุณุจู ุชุฑุงฺฉูุดโูุง ุจุนุฏ:**
```csharp
// ุจุฑูุฒุฑุณุงู ุฒูุฌุฑู ููุฌูุฏ ุจุฑุง ุชุฑุงฺฉูุดโูุง ุขุช
decimal runningBalance = balanceAfter;
foreach (var transaction in subsequentTransactions) {
    transaction.BalanceBefore = runningBalance;
    transaction.BalanceAfter = runningBalance + transaction.TransactionAmount;
    runningBalance = transaction.BalanceAfter;
}
```

---

## โ **ุชุณุช ู ุงุนุชุจุงุฑุณูุฌ:**
- โ **ฺฉุงููพุงู ูููู**: ูพุฑูฺู ุจุฏูู ุฎุทุง ฺฉุงููพุงู
- โ **ูพูุดุด ฺฉุงูู**: ุชูุธู ุฏุณุช ุจุฑุง ูุดุชุฑุ ุตูุฏูู ุงุฑุฒ ู ุญุณุงุจ ุจุงูฺฉ
- โ **ฺฉูพุงุฑฺฺฏ ุฏุงุฏู**: ุญูุธ ุฒูุฌุฑู coherent ุฏุฑ ุชูุงู ุณูุงุฑููุง
- โ **ุงููุช**: ููุท ุชุฑุงฺฉูุดโูุง Manual ูุงุจู ุญุฐู

---

## ๐ **ุงุฏุฏุงุดุชโูุง ููู:**
- ุชูุงู ุนููุงุช ุชูุธู ุฏุณุช ุงฺฉููู ุงุฒ ุทุฑู ุณุฑูุณ ูุฑฺฉุฒ ุงูุฌุงู ูโุดูุฏ
- ุฒูุฌุฑู ููุฌูุฏโูุง ุจู ุตูุฑุช coherent ุญูุธ ูโุดูุฏ
- ููุชูฺฉุดูโูุง ุณฺฏูุงูโุขุฑ ุจุฑุง ุชุบุฑุงุช ููู ุงุฑุณุงู ูโุดูุฏ
- ุงูฺฉุงู ุฑุฏุงุจ ฺฉุงูู ุชุบุฑุงุช ุฏุณุช ุจุฑุง ุญุณุงุจุฑุณ

---

## ๐ ุชุงุฑุฎ: ฒต ุขุฐุฑ ฑดฐณ - ุณุงุนุช ฑธ:ฑฐ

### ๐ฏ **ุชุณฺฉ: ุงุถุงูู ฺฉุฑุฏู ุณุชูู Note ุจู CustomerBalanceHistory**
**ูุถุนุช: โ ุชฺฉูู ุดุฏู**

---

## ๐ **ุดุฑุญ ฺฉุงูู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู:**

### **ฑ. ุงุถุงูู ฺฉุฑุฏู ูฺฺฏ Note ุจู ูุฏู CustomerBalanceHistory**
- โ **ูฺฺฏ ุฌุฏุฏ**: ุงุถุงูู ฺฉุฑุฏู `Note` ุจุง ููุน `string?` ู ูุญุฏูุฏุช ุทูู ตฐฐ ฺฉุงุฑุงฺฉุชุฑ
- โ **ูฺฺฏ Display**: ุงุถุงูู ฺฉุฑุฏู ุจุฑฺุณุจ ูุงุฑุณ "ุงุฏุฏุงุดุช"
- โ **Migration**: ุงุฌุงุฏ ู ุงุฌุฑุง migration ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ุณุชูู ุจู ูพุงฺฏุงู ุฏุงุฏู

### **ฒ. ุจุฑูุฒุฑุณุงู ูุชุฏ UpdateNotesAndDescriptions**
- โ **ููุฏ Description**: ุดุงูู ุงุทูุงุนุงุช ฺฉุงูู ุจุง ูุงู ูุดุชุฑ (ุงุฒ ุงุฏุฏุงุดุชโูุง Order/Document)
- โ **ููุฏ Note**: ุดุงูู ุฌุฒุฆุงุช ุชุฑุงฺฉูุด ุจุฏูู ุงุทูุงุนุงุช ูุดุชุฑ
- โ **ูุฑูุช Note ุจุฑุง ูุนุงููุงุช**: "USD/EUR - ููุฏุงุฑ: ฑ,ฐฐฐ USD โ ธตฐ EUR - ูุฑุฎ: ฑ.ฑทถต"
- โ **ูุฑูุช Note ุจุฑุง ุงุณูุงุฏ**: "ููุฏ - ูุจูุบ: ต,ฐฐฐ,ฐฐฐ IRR - ุดูุงุฑู: ฑฒณดตถทธน - ุนููุงู: ุงูุชูุงู ูุฌู"

### **ณ. ุชูฺฉฺฉ ุงุทูุงุนุงุช ุญุณุงุณ**
- โ **Description**: ุจุฑุง ููุงุด ุนููู ุจุง ุงุทูุงุนุงุช ูุดุชุฑ
- โ **Note**: ุจุฑุง ฺฏุฒุงุฑุดโูุง ุฏุงุฎู ุจุฏูู ุงูุดุง ุงุทูุงุนุงุช ูุดุชุฑ
- โ **ุงููุช**: ุงูฺฉุงู ุงุณุชูุงุฏู ุงุฒ Note ุฏุฑ ฺฏุฒุงุฑุดโูุง ุจุฏูู ูฺฏุฑุงู ุงุฒ ุญุฑู ุฎุตูุต

---

## ๐ง **ุฌุฒุฆุงุช ุชฺฉูฺฉ:**

### **ูฺฺฏ ุฌุฏุฏ ุฏุฑ CustomerBalanceHistory:**
```csharp
[StringLength(500)]
[Display(Name = "Note - ุงุฏุฏุงุดุช")]
public string? Note { get; set; }
```

### **ูุฑูุช Note ุจุฑุง ูุนุงููุงุช:**
```csharp
var note = $"{order.CurrencyPair} - ููุฏุงุฑ: {order.FromAmount:N0} {order.FromCurrency?.Code ?? ""} โ {order.ToAmount:N0} {order.ToCurrency?.Code ?? ""} - ูุฑุฎ: {order.Rate:N4}";
```

### **ูุฑูุช Note ุจุฑุง ุงุณูุงุฏ:**
```csharp
var note = $"{document.Type.GetDisplayName()} - ูุจูุบ: {document.Amount:N0} {document.CurrencyCode}";
if (!string.IsNullOrEmpty(document.ReferenceNumber))
    note += $" - ุดูุงุฑู: {document.ReferenceNumber}";
if (!string.IsNullOrEmpty(document.Title))
    note += $" - ุนููุงู: {document.Title}";
```

---

## ๐ **ูุชุงุฌ ู ุจูุจูุฏูุง ุญุงุตูู:**

### **ุนููฺฉุฑุฏ (Performance):**
- โก **ฺฉุงุฑุง ุจุงูุง**: ุงุถุงูู ฺฉุฑุฏู ุณุชูู ุจุฏูู ุชุงุซุฑ ุจุฑ ุนููฺฉุฑุฏ ููุฌูุฏ
- ๐ **ุณุงุฒฺฏุงุฑ**: ุญูุธ ุณุงุฎุชุงุฑ ููุฌูุฏ Description
- ๐ **ฺฏุฒุงุฑุดโุฏู ุจูุชุฑ**: ุงูฺฉุงู ฺฏุฒุงุฑุดโฺฏุฑ ุจุฏูู ุงุทูุงุนุงุช ูุดุชุฑ

### **ุงููุช ู ุญุฑู ุฎุตูุต:**
- ๐ **ุญูุธ ุญุฑู ุฎุตูุต**: Note ุจุฏูู ุงุทูุงุนุงุช ุดูุงุณุง ูุดุชุฑ
- ๐ **ฺฏุฒุงุฑุดโูุง ุฏุงุฎู**: ุงูฺฉุงู ุงุณุชูุงุฏู ุฏุฑ ฺฏุฒุงุฑุดโูุง ูุฏุฑุช
- ๐ก๏ธ **ุงููุช ุฏุงุฏู**: ุชูฺฉฺฉ ุงุทูุงุนุงุช ุญุณุงุณ ู ุนููู

### **ูุนูุงุฑ (Architecture):**
- ๐ฏ **ุฌุฏุงุณุงุฒ ูฺฏุฑุงูโูุง**: Description ุจุฑุง ููุงุดุ Note ุจุฑุง ฺฏุฒุงุฑุด
- ๐ฆ **ูุงุจู ุชูุณุนู**: ุงูฺฉุงู ุงุถุงูู ฺฉุฑุฏู ููุฏูุง ุฏฺฏุฑ ุฏุฑ ุขูุฏู
- ๐งช **ูุงุจู ุชุณุช**: ููุทู ุฌุฏุงฺฏุงูู ุจุฑุง ูุฑ ููุฏ

---

## ๐ **ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู:**
ุณุชูู Note ุจู CustomerBalanceHistory ุงุถุงูู ุดุฏู ู ุขูุงุฏู ุงุณุชูุงุฏู ูโุจุงุดุฏ. ุงู ุณุชูู ุงูฺฉุงู ุฐุฎุฑู ุฌุฒุฆุงุช ุชุฑุงฺฉูุด ุจุฏูู ุงุทูุงุนุงุช ูุดุชุฑ ุฑุง ูุฑุงูู ูโฺฉูุฏ.

**ุชุงุฑุฎ ุชฺฉูู**: ฑดฐณ/ฐน/ฒต  
**ูุถุนุช**: โ **ุชฺฉูู ุดุฏู ู ุชุณุช ุดุฏู**

---

## ๐ ุชุงุฑุฎ: ฒต ุดูุฑูุฑ ฑดฐด - ุณุงุนุช ฒฑ:ณฐ

### ๐ฏ **ุชุณฺฉ: ุจูุจูุฏ ููุชุฑูุง ฺฏุฒุงุฑุดุงุช ู ูพุงุฏูโุณุงุฒ ุตูุญูโุจูุฏ**
**ูุถุนุช: โ ุชฺฉูู ุดุฏู**

---

## ๐ ุชุงุฑุฎ: ฒต ุขุฐุฑ ฑดฐณ - ุณุงุนุช ฑด:ฐฐ

### ๐ฏ **ุชุณฺฉ: ุจุฑูุฒุฑุณุงู ุงุฏุฏุงุดุชโูุง ู ุชูุถุญุงุช ุฏุฑ ุณุณุชู ุชุจุงุฏู ุงุฑุฒ**
**ูุถุนุช: โ ุชฺฉูู ุดุฏู**

---

## ๐ **ุดุฑุญ ฺฉุงูู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู:**

### **ฑ. ุงุถุงูู ฺฉุฑุฏู ูุชุฏ UpdateNotesAndDescriptions ุจู DatabaseController**
- โ **ูุชุฏ HttpPost**: ุงุฌุงุฏ ูุชุฏ `UpdateNotesAndDescriptions` ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุฑุงฺฉูุด ุฏุชุงุจุณ
- โ **ุงููุช**: ุงุณุชูุงุฏู ุงุฒ `[Authorize(Roles = "Admin")]` ุจุฑุง ุฏุณุชุฑุณ ูุญุฏูุฏ ุจู ุงุฏููโูุง
- โ **ูุงฺฏโฺฏุฑ**: ุซุจุช ฺฉุงูู ูุฑุงุญู ุงุฌุฑุง ุจุง ูพุงูโูุง ูุงุฑุณ ู ุขูุงุฑ ููุง

### **ฒ. ุจุฑูุฒุฑุณุงู ุงุฏุฏุงุดุชโูุง ูุนุงููุงุช (Orders)**
- โ **ุงุทูุงุนุงุช ฺฉูุฏ**: ุดุงูู ูุงู ูุดุชุฑุ ุฌูุช ุงุฑุฒุ ููุฏุงุฑ ูุจุฏุง ู ููุตุฏุ ูุฑุฎ ุชุจุฏู
- โ **ูุฑูุช ููุงุด**: "ูุนุงููู USD/EUR - ูุดุชุฑ: ุนู ูุญูุฏ - ููุฏุงุฑ: ฑ,ฐฐฐ USD โ ธตฐ EUR - ูุฑุฎ: ฑ.ฑทถต"
- โ **ููุชุฑ**: ููุท ูุนุงููุงุช ุบุฑุญุฐู ุดุฏู (`!o.IsDeleted`)

### **ณ. ุจุฑูุฒุฑุณุงู ุงุฏุฏุงุดุชโูุง ุงุณูุงุฏ ุญุณุงุจุฏุงุฑ (AccountingDocuments)**
- โ **ุงุทูุงุนุงุช ฺฉูุฏ**: ุนููุงู ุณูุฏุ ูุจูุบุ ุงุฑุฒุ ูพุฑุฏุงุฎุชโฺฉููุฏู ู ุฏุฑุงูุชโฺฉููุฏู
- โ **ูุฑูุช ููุงุด**: "ููุฏ - ูุจูุบ: ต,ฐฐฐ,ฐฐฐ IRR - ุงุฒ: ูุดุชุฑ: ุนู ูุญูุฏ โ ุณุณุชู: ุจุงูฺฉ ูู - ฑฒณดตถทธน"
- โ **ููุชุฑ**: ููุท ุงุณูุงุฏ ุบุฑุญุฐู ุดุฏู (`!d.IsDeleted`)

### **ด. ุจุฑูุฒุฑุณุงู ุชูุถุญุงุช ุชุงุฑุฎฺู ููุฌูุฏ ูุดุชุฑุงู (CustomerBalanceHistory)**
- โ **ูพููุฏ ุจู ูุฑุฌุน**: ุงุชุตุงู ุจู ุงุฏุฏุงุดุชโูุง Order ู AccountingDocument
- โ **ุงููุงุน ุชุฑุงฺฉูุด**: ูพุดุชุจุงู ุงุฒ `TransactionType.Order` ู `TransactionType.AccountingDocument`
- โ **ููุชุฑ**: ููุท ุฑฺฉูุฑุฏูุง ุบุฑุญุฐู ุดุฏู (`!h.IsDeleted`)

### **ต. ุงุถุงูู ฺฉุฑุฏู ุฑุงุจุท ฺฉุงุฑุจุฑ ุจู ุตูุญู ูุฏุฑุช ูพุงฺฏุงู ุฏุงุฏู**
- โ **ฺฉุงุฑุช ุฌุฏุฏ**: ุงุถุงูู ฺฉุฑุฏู "ุจุฑูุฒุฑุณุงู ุงุฏุฏุงุดุชโูุง" ุจู ุจุฎุด Database Actions
- โ **ูุดุฏุงุฑ ุงููุช**: ูพุงู ุชุงุฏ ุจุง ุฌุฒุฆุงุช ุนููุงุช
- โ **ุทุฑุงุญ responsive**: ุณุงุฒฺฏุงุฑ ุจุง Bootstrap ู RTL ูุงุฑุณ

---

## ๐ง **ุฌุฒุฆุงุช ุชฺฉูฺฉ:**

### **ูุชุฏ DatabaseController:**
```csharp
[HttpPost]
public async Task<IActionResult> UpdateNotesAndDescriptions()
```

### **ูุฑูุช ุงุฏุฏุงุดุช ูุนุงููุงุช:**
```csharp
$"ูุนุงููู {order.CurrencyPair} - ูุดุชุฑ: {order.Customer?.FullName ?? "ูุงูุดุฎุต"} - ููุฏุงุฑ: {order.FromAmount:N0} {order.FromCurrency?.Code ?? ""} โ {order.ToAmount:N0} {order.ToCurrency?.Code ?? ""} - ูุฑุฎ: {order.Rate:N4}"
```

### **ูุฑูุช ุงุฏุฏุงุดุช ุงุณูุงุฏ:**
```csharp
$"{doc.Title} - ูุจูุบ: {doc.Amount:N0} {doc.CurrencyCode} - ุงุฒ: {doc.PayerDisplayText} โ ุจู: {doc.ReceiverDisplayText}"
```

### **ูุฑุงุญู ุงุฌุฑุง:**
1. **STEP 1**: ุจุฑูุฒุฑุณุงู ุงุฏุฏุงุดุชโูุง ูุนุงููุงุช
2. **STEP 2**: ุจุฑูุฒุฑุณุงู ุงุฏุฏุงุดุชโูุง ุงุณูุงุฏ ุญุณุงุจุฏุงุฑ  
3. **STEP 3**: ุจุฑูุฒุฑุณุงู ุชูุถุญุงุช ุชุงุฑุฎฺู ููุฌูุฏ

---

## ๐ **ูุชุงุฌ ู ุจูุจูุฏูุง ุญุงุตูู:**

### **ุนููฺฉุฑุฏ (Performance):**
- โก **ุชุฑุงฺฉูุด ุฏุชุงุจุณ**: ุนููุงุช atomic ุจุง rollback ุฏุฑ ุตูุฑุช ุฎุทุง
- ๐ **ุจูููโุณุงุฒ**: ุงุณุชูุงุฏู ุงุฒ LINQ ุจุฑุง ููุชุฑ ู join ุฏุงุฏูโูุง
- ๐ **ุขูุงุฑ ุฏูู**: ฺฏุฒุงุฑุด ุชุนุฏุงุฏ ุฑฺฉูุฑุฏูุง ุจุฑูุฒุฑุณุงู ุดุฏู

### **ุชุฌุฑุจู ฺฉุงุฑุจุฑ (UX):**
- ๐ฎ๐ท **ุฑุงุจุท ูุงุฑุณ**: ูพุงูโูุง ุชุงุฏ ู ุฎุทุง ุจู ุฒุจุงู ูุงุฑุณ
- ๐ **ุงููุช**: ุฏุณุชุฑุณ ูุญุฏูุฏ ุจู ููุด Admin
- โ๏ธ **ูุดุฏุงุฑ**: ูพุงูโูุง ุชุงุฏ ุจุง ุฌุฒุฆุงุช ุนููุงุช

### **ูุนูุงุฑ (Architecture):**
- ๐ฏ **Centralized**: ุนููุงุช ุฏุฑ DatabaseController ูุชูุฑฺฉุฒ
- ๐ฆ **Consistent**: ุงุณุชูุงุฏู ุงุฒ ุงูฺฏููุง ููุฌูุฏ ุฏุฑ ูพุฑูฺู
- ๐งช **Testable**: ูุชุฏ ูุงุจู ุชุณุช ู debug ูุณุชูู

---

## ๐ **ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู:**
ุณุณุชู ุจุฑูุฒุฑุณุงู ุงุฏุฏุงุดุชโูุง ู ุชูุถุญุงุช ุขูุงุฏู ุงุณุชูุงุฏู ูโุจุงุดุฏ. ุงู ุนููุงุช ุงุทูุงุนุงุช ฺฉูุฏ ุฑุง ุฏุฑ ุงุฏุฏุงุดุชโูุง ุฐุฎุฑู ฺฉุฑุฏู ู ุชูุถุญุงุช ุชุงุฑุฎฺู ุฑุง ุจุง ูุฑุฌุน ูุฑุชุจุท ูพุฑ ูโฺฉูุฏ.

**ุชุงุฑุฎ ุชฺฉูู**: ฑดฐณ/ฐน/ฒต  
**ูุถุนุช**: โ **ุชฺฉูู ุดุฏู ู ุชุณุช ุดุฏู**

---

## ๐ ุชุงุฑุฎ: ฒต ุดูุฑูุฑ ฑดฐด - ุณุงุนุช ฒฑ:ณฐ

### ๐ฏ **ุชุณฺฉ: ุจูุจูุฏ ููุชุฑูุง ฺฏุฒุงุฑุดุงุช ู ูพุงุฏูโุณุงุฒ ุตูุญูโุจูุฏ**
**ูุถุนุช: โ ุชฺฉูู ุดุฏู**

---

## ๐ **ุดุฑุญ ฺฉุงูู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู:**

### **ฑ. ุญุฐู ููุชุฑ ุญุณุงุจ ุจุงูฺฉ ุงุฒ ฺฏุฒุงุฑุดุงุช ูุดุชุฑ (CustomerReports)**
- โ **ุญุฐู ุดุฏู**: ุนูุตุฑ HTML ุจุฑุง dropdown ุญุณุงุจ ุจุงูฺฉ
- โ **ุญุฐู ุดุฏู**: ุชุงุจุน `loadBankAccounts()` ุงุฒ CustomerReports
- โ **ุญุฐู ุดุฏู**: event listener ุจุฑุง ุชุบุฑ ุญุณุงุจ ุจุงูฺฉ
- โ **ุญุฐู ุดุฏู**: ูพุงุฑุงูุชุฑ `bankAccountId` ุงุฒ ุฏุฑุฎูุงุณุชโูุง API
- โ **ุชูุฒ ุดุฏู**: ฺฉุฏูุง ูุฑุจูุท ุจู export ู ุณุงุฑ ุชูุงุจุน

### **ฒ. ุงุถุงูู ฺฉุฑุฏู ููุชุฑ ุญุณุงุจ ุจุงูฺฉ ู ุตูุญูโุจูุฏ ุจู ฺฏุฒุงุฑุดุงุช ุงุณูุงุฏ (DocumentReports)**

#### **ุชุบุฑุงุช Backend (ReportsController.cs):**
- โ **GetDocumentsData**: ุงูุฒูุฏู ูพุงุฑุงูุชุฑูุง `bankAccount`, `page`, `pageSize`
- โ **GetDocumentsDataWithFile**: ุงูุฒูุฏู ูพุงุฑุงูุชุฑูุง ูุดุงุจู ุจุฑุง ุฌุณุชุฌู ูุงู
- โ **ููุชุฑ ุญุณุงุจ ุจุงูฺฉ**: ูพุงุฏูโุณุงุฒ ุจุง `PayerBankAccountId` ุง `ReceiverBankAccountId`
- โ **ุตูุญูโุจูุฏ ุณูุช ุณุฑูุฑ**: ุงุณุชูุงุฏู ุงุฒ `.Skip()` ู `.Take()`
- โ **metadata**: ุจุงุฒฺฏุดุช ุงุทูุงุนุงุช pagination (totalPages, currentPage, totalRecords)

#### **ุชุบุฑุงุช Frontend (DocumentReports.cshtml):**
- โ **HTML Structure**: ุงุถุงูู ฺฉุฑุฏู `<nav id="documentsPagination">`
- โ **JavaScript Variables**: `currentPage = 1`, `pageSize = 10`
- โ **ุชูุงุจุน ุตูุญูโุจูุฏ**: 
  - `updatePagination()` ุจุง UI ูุงุฑุณ (ูุจู/ุจุนุฏ)
  - `loadDocumentReportsPage(page)` ุจุฑุง navigation
- โ **ูพุงุฑุงูุชุฑูุง API**: ุงุถุงูู ฺฉุฑุฏู pagination ุจู FormData ู GET requests
- โ **ูุฏุฑุช ููุชุฑูุง**: reset ฺฉุฑุฏู pagination ุฏุฑ ุชุบุฑ ููุชุฑูุง

### **ณ. ูพุงุฏูโุณุงุฒ ุจุงุฑฺฏุฐุงุฑ ุงุฑุฒูุง ุงุฒ ุฏุชุงุจุณ**
- โ **loadCurrencies()**: ุชุงุจุน ุฌุฏุฏ ุจุฑุง ุฏุฑุงูุช ุงุฑุฒูุง ุงุฒ `/api/currencies`
- โ **ุญุฐู hardcoded values**: ูพุงฺฉ ฺฉุฑุฏู ฺฏุฒููโูุง ุซุงุจุช USD, EUR, AED, IRR
- โ **ูุฑูุช ููุงุด**: "ูุงู ุงุฑุฒ (ฺฉุฏ)" ูุซู "US Dollar (USD)"
- โ **Error handling**: ูุฏุฑุช ุฎุทุงูุง ุจุง ูพุงูโูุง ูุงุฑุณ

### **ด. ุจูุจูุฏ ุจุงุฑฺฏุฐุงุฑ ุญุณุงุจโูุง ุจุงูฺฉ**
- โ **loadBankAccounts()**: ุจูุจูุฏ ุชุงุจุน ููุฌูุฏ
- โ **API endpoint**: ุชุตุญุญ ูุณุฑ ุจู `/api/bankaccounts`
- โ **ูุฑูุช ููุงุด**: "ูุงู ุจุงูฺฉ - ุดูุงุฑู ุญุณุงุจ"
- โ **Console logging**: ุงูุฒูุฏู debug ุจุฑุง ุดูุงุณุง ูุณุงุฆู

---

## ๐ง **ุฌุฒุฆุงุช ุชฺฉูฺฉ:**

### **API Endpoints ุงุณุชูุงุฏู ุดุฏู:**
- `GET /api/currencies` - ุฏุฑุงูุช ููุฑุณุช ุงุฑุฒูุง
- `GET /api/bankaccounts` - ุฏุฑุงูุช ุญุณุงุจโูุง ุจุงูฺฉ
- `GET /Reports/GetDocumentsData` - ฺฏุฒุงุฑุด ุงุณูุงุฏ ุจุง pagination
- `POST /Reports/GetDocumentsDataWithFile` - ฺฏุฒุงุฑุด ุงุณูุงุฏ ุจุง ุฌุณุชุฌู ูุงู

### **ูพุงุฑุงูุชุฑูุง ุฌุฏุฏ:**
```csharp
// Backend parameters
string? bankAccount, int page = 1, int pageSize = 10

// Frontend variables  
currentPage = 1, pageSize = 10
```

### **ุณุงุฎุชุงุฑ Pagination Response:**
```json
{
  "documents": [...],
  "pagination": {
    "currentPage": 1,
    "totalPages": 5,
    "totalRecords": 45,
    "pageSize": 10
  }
}
```

---

## ๐ **ูุชุงุฌ ู ุจูุจูุฏูุง ุญุงุตูู:**

### **ุนููฺฉุฑุฏ (Performance):**
- โก **ุตูุญูโุจูุฏ ุณูุช ุณุฑูุฑ**: ฺฉุงูุด ุงูุชูุงู ุฏุงุฏู ู ุจูุจูุฏ ุณุฑุนุช
- ๐ **ุจุงุฑฺฏุฐุงุฑ Dynamic**: ุงุฑุฒูุง ู ุญุณุงุจโูุง ุงุฒ ุฏุชุงุจุณ ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ
- ๐ฑ **UI Responsive**: ุตูุญูโุจูุฏ ุจุง ุทุฑุงุญ Bootstrap ุณุงุฒฺฏุงุฑ

### **ุชุฌุฑุจู ฺฉุงุฑุจุฑ (UX):**
- ๐ฎ๐ท **ูุงุฑุณ RTL**: navigation ุจุง "ูุจู"/"ุจุนุฏ"
- ๐ **ููุชุฑ ููุดููุฏ**: reset ุฎูุฏฺฉุงุฑ pagination ุฏุฑ ุชุบุฑ ููุชุฑูุง
- โ๏ธ **Error handling**: ูพุงูโูุง ุฎุทุง ูุงุถุญ ู ูุงุฑุณ
- ๐ **Debug support**: console logging ุจุฑุง troubleshooting

### **ูุนูุงุฑ (Architecture):**
- ๐ฏ **Separation of concerns**: CustomerReports ู DocumentReports ูุฌุฒุง
- ๐ฆ **Consistent API**: ฺฉุณุงูโุณุงุฒ endpoint patterns
- ๐ **Type safety**: ูพุงุฑุงูุชุฑูุง strongly typed ุฏุฑ C#
- โป๏ธ **Reusable components**: ุชูุงุจุน pagination ูุงุจู ุงุณุชูุงุฏู ูุฌุฏุฏ

---

## โ **ุชุณุช ู ุชุงุฏ:**
- โ ฺฉุงููพุงู ูููู ูพุฑูฺู
- โ ุจุงุฑฺฏุฐุงุฑ ุตุญุญ dropdown ูุง
- โ ุนููฺฉุฑุฏ ุตูุญูโุจูุฏ ุชุณุช ุดุฏู
- โ ููุชุฑูุง ุชุฑฺฉุจ ฺฉุงุฑ ูโฺฉููุฏ
- โ ุฌุณุชุฌู ูุงู ุจุง pagination ุณุงุฒฺฏุงุฑ ุงุณุช

---

## ๐ **ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู:**
ูพุฑูฺู ุจุง ุชูุงู ูฺฺฏโูุง ุฌุฏุฏ ุขูุงุฏู ู ุฏุฑ ุญุงู ุงุฌุฑุง ูโุจุงุดุฏ.

**ุชุงุฑุฎ ุชฺฉูู**: ฒต ุดูุฑูุฑ ฑดฐด  
**Commit Hash**: `082ec8c`  
**ูุถุนุช**: โ **ุชฺฉูู ุดุฏู ู ุชุงุฏ ุดุฏู**

---

## ๐ ุชุงุฑุฎ: ฑดฐณ/ฐน/ฒน - ุณุงุนุช ฑด:ฐฐ

### ๐ฏ **ุชุณฺฉ: ูพุงุฏูโุณุงุฒ ุณุณุชู ฺุงูพ ฺฉูพุงุฑฺู ฺฏุฒุงุฑุดโูุง ูุงู ุจุง ูุงูุจ ุญุฑููโุง ุจุงูฺฉ**
**ูุถุนุช: โ ุชฺฉูู ุดุฏู**

---

## ๐ **ุดุฑุญ ฺฉุงูู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู:**

### **ฑ. ูุนูุงุฑ ฺฉูพุงุฑฺู ฺุงูพ ฺฏุฒุงุฑุดโูุง**
- โ **FinancialReportViewModel**: ุงุฌุงุฏ ูุฏู generic ุจุฑุง ูุฏุฑุช ุฏุงุฏูโูุง ฺฏุฒุงุฑุด
- โ **FinancialTransactionItem**: ุงุฌุงุฏ ูุฏู ุงุณุชุงูุฏุงุฑุฏ ุจุฑุง ุขุชูโูุง ุชุฑุงฺฉูุด
- โ **PrintFinancialReport.cshtml**: ุจูโุฑูุฒุฑุณุงู ูู ุจุง ูุงูุจ ุญุฑููโุง ุจุงูฺฉ ฺฉูพุงุฑฺู

### **ฒ. ูพุงุฏูโุณุงุฒ ูุชุฏูุง ฺุงูพ ุฏุฑ ReportsController**
- โ **PrintBankAccountReport**: ูุชุฏ ุฌุฏุฏ ุจุฑุง ฺุงูพ ฺฏุฒุงุฑุด ุญุณุงุจ ุจุงูฺฉ
- โ **PrintPoolReport**: ูุชุฏ ุฌุฏุฏ ุจุฑุง ฺุงูพ ฺฏุฒุงุฑุด ุตูุฏูู ุงุฑุฒ
- โ **ุชุจุฏู ุฏุงุฏูโูุง**: ุชุจุฏู timeline ู summary ุจู FinancialReportViewModel

### **ณ. ุจูโุฑูุฒุฑุณุงู CustomerFinancialHistoryController**
- โ **PrintFinancialReport**: ุจูโุฑูุฒุฑุณุงู ูุชุฏ ููุฌูุฏ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ูุฏู generic

### **ด. ุงุตูุงุญ ุชูุงุจุน JavaScript**
- โ **BankAccountReports.cshtml**: ุจูโุฑูุฒุฑุณุงู ุชุงุจุน printBankAccountReport
- โ **PoolReports.cshtml**: ุจูโุฑูุฒุฑุณุงู ุชุงุจุน printPoolReport
- โ **CustomerReports.cshtml**: ุจูโุฑูุฒุฑุณุงู ุชุงุจุน printCustomerReport

### **ต. ุฑูุน ุจุงฺฏโูุง ุงููุช ู ุจูุจูุฏ error handling**
- โ **Null Safety**: ุงุถุงูู ฺฉุฑุฏู ุจุฑุฑุณโูุง null ุจุฑุง timeline ู summary
- โ **Safe Parsing**: ุงุณุชูุงุฏู ุงุฒ `DateTime.TryParse` ุจู ุฌุง `DateTime.Parse`
- โ **Safe Conversion**: ุงุณุชูุงุฏู ุงุฒ `Convert.ToDecimal` ุจุฑุง ุชุจุฏู ููุงุฏุฑ
- โ **Error Handling**: ุชุบุฑ ุงุฒ `View("Error")` ุจู `StatusCode(500)`
- โ **Defensive Programming**: ูพุฑุฏุงุฒุด individual transactions ุจุง try-catch

### **ถ. ุชุณุช ู ุงุนุชุจุงุฑุณูุฌ**
- โ **Pool Reports**: ุชุณุช ูููู ุจุง ูุงูุจ ุญุฑููโุง ุจุงูฺฉ
- โ **BankAccount Reports**: ุฑูุน NullReferenceException ู ุชุณุช ูููู
- โ **Consistency**: ุงุนูุงู ุงุตูุงุญุงุช ูุดุงุจู ุจุฑ ุฑู ูุฑ ุฏู ูุชุฏ ฺุงูพ
- โ **UI Modification**: ุญุฐู ุณุชูู "ุงุฑุฒ" ุงุฒ ฺฏุฒุงุฑุด ุญุณุงุจ ุจุงูฺฉ

---

## โ **ุชุณุช ู ุชุงุฏ:**
- โ ฺฉุงููพุงู ูููู ูพุฑูฺู ุจุฏูู ุฎุทุง
- โ ูุงูุจ ุญุฑููโุง ุจุงูฺฉ ฺฉุณุงู ุจุฑุง ููู ฺฏุฒุงุฑุดโูุง
- โ ุนุฏู ูุฌูุฏ NullReferenceException ุฏุฑ ฺุงูพ ุญุณุงุจ ุจุงูฺฉ
- โ ูุฏุฑุช ุงูู ุฎุทุงูุง ู ุฏุงุฏูโูุง ูุงูุนุชุจุฑ
- โ ุนููฺฉุฑุฏ consistent ุฏุฑ ููู ุงููุงุน ฺฏุฒุงุฑุดโูุง
- โ ุญุฐู ุณุชูู ุงุฑุฒ ุงุฒ ุฌุฏูู ุชุฑุงฺฉูุดโูุง

---

## ๐ **ูุงูโูุง ุชุบุฑ ุงูุชู:**
- `Controllers/ReportsController.cs` - ุงุถุงูู ฺฉุฑุฏู ูุชุฏูุง ฺุงูพ ุจุง defensive programming
- `Controllers/CustomerFinancialHistoryController.cs` - ุจูโุฑูุฒุฑุณุงู ูุชุฏ ฺุงูพ
- `Models/AccountViewModels.cs` - ุงุถุงูู ฺฉุฑุฏู ูุฏูโูุง generic
- `Views/CustomerFinancialHistory/PrintFinancialReport.cshtml` - ูุงูุจ ฺฉูพุงุฑฺู ู ุญุฐู ุณุชูู ุงุฑุฒ
- `Views/Reports/BankAccountReports.cshtml` - ุจูโุฑูุฒุฑุณุงู JavaScript
- `Views/Reports/PoolReports.cshtml` - ุจูโุฑูุฒุฑุณุงู JavaScript
- `Views/CustomerFinancialHistory/CustomerReports.cshtml` - ุจูโุฑูุฒุฑุณุงู JavaScript

---

## ๐ **ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู:**
ุณุณุชู ฺุงูพ ฺฉูพุงุฑฺู ุจุง ุงููุช ุจุงูุง ู ูุงูุจ ุญุฑููโุง ุขูุงุฏู ุงุณุชูุงุฏู ูโุจุงุดุฏ. ุณุชูู ุงุฑุฒ ุงุฒ ฺฏุฒุงุฑุด ุญุณุงุจ ุจุงูฺฉ ุญุฐู ุดุฏู ุงุณุช.

**ุชุงุฑุฎ ุชฺฉูู**: ฑดฐณ/ฐน/ฒน  
**ูุถุนุช**: โ **ุชฺฉูู ุดุฏู ู ุชุณุช ุดุฏู**